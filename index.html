<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ap_name}}</title>
</head>

<body>
    <h1>HotDogBot v1</h1>
    
    Press button on controller to connect.

    <div>
        <label>X:<progress id="x" value=0></progress></label>
    </div>

    <div>
        <label>Y:<progress id="y" value=0></progress></label>
    </div>

<script>
    window.addEventListener('gamepadconnected', (event) => {
        const update = () => {
            const x_progress = document.getElementById('x');
            const y_progress = document.getElementById('y');

            const gamepad = navigator.getGamepads()[0];
            if (gamepad) {
                // Get values from gamepade
                const x = gamepad.axes[0];
                const y = gamepad.axes[1];
                
                // Update progress bars
                x_progress.value = x * 0.5 + 0.5;
                y_progress.value = y * 0.5 + 0.5;

                // Send data to bot
                fetch(window.location.origin + "/control", {
                    method: "POST",
                    body: JSON.stringify({x, y}),
                    headers: {"Content-type": "application/json; charset=UTF-8"}
                }).catch((error) => console.log(error));
            }

            requestAnimationFrame(update);
        };

        update();
    });
</script>

</body>

</html>
